---
# Provision a CentOS 9 host for Ansible

- name: Find out the Ethernet Interface
  ansible.builtin.shell:
    cmd: "nmcli -t device | grep ethernet:connected | cut -d ':' -f 1 -"
    register: iface

- name: Add an Ethernet connection with static IP configuration
    community.general.nmcli:
      conn_name: "{{ iface }}"
      ifname: "{{ iface }}"
      type: ethernet
      ip4: 192.0.2.100/24
      gw4: 192.0.2.1
      state: present
